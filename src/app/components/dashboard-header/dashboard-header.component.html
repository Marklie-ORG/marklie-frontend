<div class="dashboard-header flex-row justify-between align-center">
  <div class="d-flex flex-row align-center gap-3">
    <a href="/dashboard" class="logo">
      <img src="../../../favicon.png" alt="logo" width="40px" />
    </a>
    <a href="/dashboard" class="nav-btn">Clients</a>
    <!-- <a href="/scheduled-reports" class="nav-btn">Scheduled Reports</a> -->
    <a href="/reports-database" class="nav-btn badge-container">
      Reports Database
      @if (pendingReviewCount > 0) {
        <span class="badge">{{ pendingReviewCount }}</span>
      }
    </a>
    <a href="/suggested-features" class="nav-btn">Request Feature</a>
    <a href="/access-requests" class="nav-btn">Access Requests</a>
  </div>

  <div class="d-flex flex-row align-center gap-3">
    <div class="feedback-container" [class.open]="isFeedbackOpen" #feedbackContainer>
      <button type="button" class="feedback-toggle" (click)="toggleFeedback()">
        <fa-icon [icon]="faComment"></fa-icon>
        Give Feedback
      </button>

      <div class="feedback-popover" *ngIf="isFeedbackOpen">
        <textarea
          class="feedback-input"
          rows="3"
          maxlength="1000"
          placeholder="Share your thoughts..."
          [(ngModel)]="feedbackMessage"
          (keydown)="onFeedbackKeydown($event)"
        ></textarea>
        <div class="feedback-actions">
          <span class="hint">Press Enter with Cmd/Ctrl to send</span>
          <button type="button" class="send-btn" [disabled]="sending || !feedbackMessage.trim()" (click)="sendFeedback()">
            {{ sending ? 'Sendingâ€¦' : 'Send' }}
          </button>
        </div>
        <div class="feedback-status" *ngIf="feedbackSent">Thanks for your feedback!</div>
      </div>
    </div>

    <div class="user-dropdown-container">
      <button
        class="user-dropdown"
        type="button"
        (click)="toggleDropdown()"
        (keydown)="onTriggerKeydown($event)"
        [attr.aria-haspopup]="'menu'"
        [attr.aria-expanded]="isDropdownOpen"
        [attr.aria-controls]="'user-menu'"
        #triggerButton
      >
        <span class="user-name">{{ userName }}</span>
        <fa-icon [icon]="faChevronDown"></fa-icon>
      </button>

      <div
        class="dropdown-menu"
        *ngIf="isDropdownOpen"
        role="menu"
        id="user-menu"
        (keydown)="onMenuKeydown($event)"
        #menu
      >
        <a href="/profile" role="menuitem" tabindex="-1" #menuItem (click)="onMenuItemClick()">
          <fa-icon [icon]="faUser"></fa-icon> Profile
        </a>
        <a href="/billing" role="menuitem" tabindex="-1" #menuItem (click)="onMenuItemClick()">
          <fa-icon [icon]="faCreditCard"></fa-icon> Billing
        </a>
        <!-- <a href="/support" role="menuitem" tabindex="-1" #menuItem (click)="onMenuItemClick()">
          <fa-icon [icon]="faCommentDots"></fa-icon> Support
        </a> -->
        <a href="/" role="menuitem" tabindex="-1" #menuItem (click)="signOut($event)">
          <fa-icon [icon]="faArrowRightFromBracket"></fa-icon> Logout
        </a>
      </div>
    </div>
  </div>
</div>
