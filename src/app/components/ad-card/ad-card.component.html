<h1>Best creatives</h1>

<div #adAccountsContainer>
@for (adAccount of adAccounts(); track adAccount.id) {
  @if (adAccount.enabled) {
    <div class="ad-account-item" [attr.data-adaccount-id]="adAccount.id">
      <div class="ad-account-header mb-2 mt-4 d-flex justify-between align-center">
        <h4 class="">{{ adAccount.name }}</h4>
        <div class="d-flex align-center">

          @if (!isViewMode() && !isReviewMode()) {
            <label class="mr-2">Show:</label>
            <select class="select-default mr-3" value="{{getCreativesLimit(adAccount)}}" (change)="onCreativesLimitChange(adAccount.id, $any($event.target).value)">
                <option value="3">{{ 3 }}</option>
                <option value="5">{{ 5 }}</option>
                <option value="10">{{ 10 }}</option>
            </select>
            <label class="mr-2">Best creatives by:</label>
            <select class="select-default mr-3" [ngModel]="getCreativesSortMetric(adAccount)"  (change)="onCreativesSortMetricChange(adAccount.id, $any($event.target).value)">
              @for (opt of getAdAccountSortOptions(adAccount); track opt.value) {
                <option [value]="opt.value + ''">{{ opt.label }}</option>
              }
            </select>
          }
          
          @if (!isViewMode() && adAccounts().length > 1) {
            <metrics-actions-menu
            [adAccounts]="adAccounts()"
            [sourceAdAccountId]="'' + adAccount.id"
            (adAccountsChange)="adAccounts.set($event)"
            ></metrics-actions-menu>
          }
        </div>
      </div>

      <div class="ad-grid" >
        <div class="ad-card" *ngFor="let creative of ((getSortedCreatives(adAccount)) | slice:0:getCreativesLimit(adAccount)); let i = index">
          <div class="ad-image-container cursor-pointer " (click)="openAd(creative.sourceUrl)">
            <img class="ad-media" [src]="creative.thumbnailUrl || '../../../assets/img/2025-03-19%2013.02.21.jpg'"/>
          </div>
          <div class="metrics" #adsGridContainer [attr.data-ad-account-id]="adAccount.id">
            <div class="metric">
              <!-- <div class="metric-label">{{ metricsService.getFormattedMetricName('ad_name') }}</div> -->
              <div class="ad-name" [attr.data-full-text]="creative.ad_name" (click)="copyToClipboard(creative.ad_name, $event)">{{ creative.ad_name }}</div>
            </div>
            @for (point of getOrderedCreativePoints(adAccount, creative); track point.name) {
              <div class="metric cursor-pointer" [class.enabled]="isMetricEnabled(adAccount, point.name)" [attr.data-metric-name]="point.name">
                <div class="metric-label">{{ metricsService.getFormattedMetricName(point.name) }}</div>
                <div class="metric-value">{{ point.currency ? ((point.value | number:'1.0-2') + ' ' + point.currency) : metricsService.formatMetricValue(point.name, point.value) }}{{ point.symbol || '' }}</div>
              </div>
            }
          </div>
        </div>
      
      </div>
    </div>
  }
  
}
</div>

