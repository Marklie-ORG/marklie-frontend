<div class="checkout">
  <header class="checkout__header">
    <h1>Add a payment method</h1>
    <p class="checkout__sub">Your card will be saved and used for invoices.</p>
  </header>

  <section class="summary" *ngIf="plan">
    <div class="summary__left">
      <h2 class="summary__title">{{ plan.name }}</h2>
      <!-- <ul class="summary__features" *ngIf="plan.limits as l">
        <li>Up to {{ l.clients.max }} clients</li>
        <li>Up to {{ l.teamMembers.max }} team members</li>
      </ul> -->
    </div>
    <div class="summary__right">
      <div class="price">
        <span class="price__amount">{{ plan.price | currency:'USD' }}</span>
        <span class="price__interval">/ {{ plan.interval }}</span>
      </div>
    </div>
  </section>

  <form (ngSubmit)="onSubmit()" [class.form--busy]="submitting">
    <!-- Email only -->
    <div class="field field--full">
      <span class="field__label">Email</span>
      <input
        class="field__input"
        type="email"
        [(ngModel)]="email"
        name="email"
        required
      />
    </div>

    <!-- Payment Element -->
    <div class="field field--full">
      <!-- <span class="field__label">Payment details</span> -->
      <div id="payment-element"></div>
      @if (cardError) {
        <div class="error" >{{ cardError }}</div>
      }
      
    </div>

    <button class="btn" type="submit" [disabled]="submitting || !ready">
      {{ submitting ? 'Saving…' : 'Save & Subscribe' }}
    </button>
  </form>

  @if (success) {
    <div class="success">
      <div class="success__icon">✓</div>
      <h3>All set!</h3>
      <p>Payment method saved and subscription created.</p>
    </div>
  }
  
</div>
