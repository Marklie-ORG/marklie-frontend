<div class="block-header">
  <h3 class="block-header__title">Activity</h3>
  <a class="block-header__link" [routerLink]="['/activity']">See all activity â†—</a>
</div>
  <table class="activity__table">
    <thead>
    <tr>
      <th class="activity__dot-cell"></th>
      <th>Date</th>
      @if (level === 'organization') {
        <th class="activity__client">Client name</th>
      }
      <th>Activity</th>
    </tr>
    </thead>
    <tbody>
      @for (log of groupedLogs; track log.createdAt) {
        @if (!(log.action === 'client_created' && level !== 'organization')) {
          <tr
            class="activity__row"
            (click)="navigateToLog(log)"
            [class.activity__row--clickable]="!!getRoute(log)"
          >
            <td class="activity__dot-cell">
            <span
              [class.activity__dot--visible]="isNew(log)"
              class="activity__dot"
            ></span>
          </td>

          <td class="activity__date">
            {{ formatTimeOrDate(log.createdAt) }}
          </td>

          @if (level === 'organization') {
            <td class="activity__client">
              {{ log.client?.name || log.metadata.name || '-' }}
            </td>
          }

          <td class="activity__activity">
            @switch (log.action) {
              @case ('report_sent') {
                {{ log.metadata.reportName || 'Report' }}
                has been sent.
              }

              @case ('report_generated') {
                {{ log.metadata.reportName || 'Report' }}
                has been generated.
              }

              @case ('created_schedule') {
                Schedule created
              }

              @case ('updated_schedule') {
                Schedule updated
              }

              @case ('paused_schedule') {
                Schedule paused
              }

              @case ('added_collaborator') {
                Collaborator added
              }

              @case ('client_created') {
                @if (level === 'organization') {
                  Client <strong>{{ log.metadata.name || 'Unknown client' }}</strong> added to the platform
                }
              }

              @default {
                {{ log.message || 'Activity logged' }}
              }
            }
          </td>
        </tr>
      }
      }
    </tbody>
  </table>
